<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>vim的使用</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="doc/linux-style.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">vim的使用</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#vim的使用">vim的使用</a></li>
</ul>
</nav>
<h1 id="vim的使用">vim的使用</h1>
<p><a href="https://www.runoob.com/linux/linux-vim.html">Vim编辑器菜鸟教程</a></p>
<p><a href="https://yianwillis.github.io/vimcdoc/doc/quickref.html">Vim官方手册中文版</a></p>
<p>作为一个linux内核开发工作者，vim真的必须得学会掌握。这里我列举几个常用的：</p>
<ul>
<li><strong>基础操作</strong></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>:<span class="ex">w</span>      #保存文件</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>:<span class="ex">wq</span>或zz      #保存并退出</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="ex">x</span>       #删除光标所在字符 </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="fu">dd</span>          #删除当前行</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="ex">gg</span>      #定位到首行</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="ex">u</span>       #撤回操作</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>[<span class="ex">Ctrl</span>]+r      #重做上一个动作。</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>:<span class="ex">5</span>,10d      #删除5到10行</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="ex">ctrl</span> + f  #屏幕<span class="st">&#39;向下&#39;</span>移动一页</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="ex">ctrl</span> + b   #    屏幕<span class="st">&#39;向上&#39;</span>移动一页</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="ex">0</span> 或功能键[Home]    #这是数字： 0 “：移动到这一行的最前面字符处 </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>$ 或功能键[<span class="ex">End</span>]     #移动到这一行的最后面字符处</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="ex">G</span>      #将文件移动到此文件的最后一行</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a><span class="ex">n</span><span class="op">&lt;</span>Enter<span class="op">&gt;</span>    #n 为数字。 光标向下移动 n 行</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="ex">/keyword</span>    #向下搜索 keyword</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="ex">?keyword</span>    #向上搜索 keyword</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a>:<span class="ex">n1</span>,n2s/word1/word2/g   #n1 与 n2 为数字。 在 n1 和 n2 行之间寻找 word1 这个字符串， 并将该字符串替换为 word2 ！ 举例来说，在 100 到 200 行之间搜寻 cird 并取代为 VBIRD 则：</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a>『:<span class="ex">100</span>,200s/vbird/VBIRD/g』。</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a>:<span class="ex">1</span>,<span class="va">$s</span>/word1/word2/g  #从第一行到最后一行查找 word1 字符串，并将该字符串替换为 word2 </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a><span class="ex">r</span> #进入取代模式</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a><span class="ex">Ctrl</span> + Z    #挂起 Vim 到后台</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a><span class="bu">fg</span>      #从后台恢复 Vim</span></code></pre></div>
<ul>
<li><strong>vim阅读源码</strong></li>
</ul>
<p>vim还有一个高级的用法就是用vim阅读内核源码：首先需要在根目录下执行<code>ctags -R</code> 这个命令会生成索引文件，<code>ls -l tags</code>查看索引文件。</p>
<p>找不到需要下载ctags，运行<code>sudo apt-get install exuberant-ctags</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>然后<span class="ex">vim</span>中：</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="ex">1.ctrl</span> + ] #跳转到函数或者变量的定义</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="ex">2.</span> ctrl + o #返回到原来的位置</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="ex">3.</span> g ctrl +] #跳转到函数或者变量的定义，这个比第一个多一个选择。</span></code></pre></div>
<ul>
<li><strong>vim的暂存档</strong></li>
</ul>
<p>当你某次用某个进程编辑vim的时候，可能因为网络问题或者中断问题，没有保存vim的编辑内容。</p>
<p>但是vim会自动保存一个xxx.swp文件，以实现内容暂存。再一次用vim打开这个文件的时候，可以按下如下按键：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="ex">R</span>：加载暂存文档的内容；D：删除暂存文档的内容；O：打开此文件为只读文件；</span></code></pre></div>
<ul>
<li><strong>vim还可以实现多文件编辑</strong></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="ex">vim</span> 1.txt 2.txt 3.txt #可以用vim一次性打开三个文件</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="co">#然后有如下指令查看</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>:<span class="ex">n</span>  #编辑下一个文件</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>:<span class="ex">N</span>  #编辑下一个文件</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>:<span class="ex">files</span>    #列出目前这个 vim 的开启的所有文件</span></code></pre></div>
<ul>
<li><strong>vim的多窗口编辑</strong></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>:<span class="ex">vsp</span>  #水平分割 上下两个窗口</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>:<span class="ex">sp</span>   #垂直分割 左右两个窗口</span></code></pre></div>
<ul>
<li><strong>vim复制到系统剪贴板</strong></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="fu">sudo</span> apt update</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="fu">sudo</span> apt install vim-gtk   #安装支持剪贴板的 Vim 版本</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>:<span class="ex">echo</span> has(<span class="st">&#39;clipboard&#39;</span>)   #现在应该返回 <span class="ex">1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>:<span class="ex">version</span>              #  查看是否包含 +clipboard</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="st">&quot;+y              #复制选中内容到剪贴板    </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="st">&quot;</span><span class="ex">+p</span>              #粘贴剪贴板内</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="st">&quot;+yy             #复制整行  </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a><span class="st">:%y+             #复制整个文件    </span></span></code></pre></div>
<ul>
<li><strong>~/.vimrc的一些配置</strong></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">set</span> <span class="ex">number</span>              <span class="st">&quot;显示行号</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="st">syntax on               &quot;</span>语法高亮</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="kw">set</span> <span class="ex">paste</span>               <span class="st">&quot;粘贴不自动缩进</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="st">set ruler               &quot;</span>右下角显示位置</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="kw">set</span> <span class="ex">hlsearch</span>            <span class="st">&quot;搜索高亮</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="st">set fdm=indent          &quot;</span>indent缩进折叠，syntax语法折叠</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="kw">set</span> <span class="va">pastetoggle=</span><span class="op">&lt;</span><span class="ex">F9</span><span class="op">&gt;</span>    <span class="st">&quot;F9粘贴设置切换</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="st">set mouse-=a                    &quot;</span>鼠标选择文字不会进入visual模式</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a><span class="kw">set</span> <span class="ex">ic</span>                  <span class="st">&quot;set ic忽略大小写(ignore case), set noic 不忽略大小写</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a><span class="st">set cscopequickfix=a-,c-,d-,e-,f-,g-,i-,s-,t- &quot;</span>cscope打开quickfix窗口</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a><span class="st">&quot;set ts=4                &quot;</span>一个<span class="ex">tab</span>键等于4个空格宽度</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a><span class="st">&quot;set sw=4                &quot;</span>按<span class="op">&lt;</span>键和<span class="op">&gt;</span>键缩进时，移动<span class="ex">4</span>个空格</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a><span class="st">&quot;set expandtab           &quot;</span><span class="ex">tab</span>转化为空格</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a><span class="st">&quot;colorscheme desert      &quot;</span>支持的<span class="ex">color</span>查看/usr/share/vim/vim82/colors/（vim82是vim版本）</span></code></pre></div>
</body>
</html>
